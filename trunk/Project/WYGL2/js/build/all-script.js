/*
 * HdAgency JS. Hudongsoft.cn
 */
Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.sjlrGrid=Ext.extend(Ext.grid.GridPanel,{jfgl:false,dispalyDetails:function(){var b=this;var d=b.getSelectionModel().getSelected();if(d){function e(h){var g=d.data;return g[h+"_年"]+"/"+g[h+"_月"]+"/"+g[h+"_日"]}var c='<table class="tab1"><tr style="height:20px;"><td><strong>合同编号：</strong>'+d.data.编码+"<td><td><strong>客户编号：</strong>"+d.data.客户编码+"<td><td><strong>客户名称:</strong>"+d.data.客户名称+'<td></tr><tr style="height:20px;"><td><strong>联系电话：</strong>'+d.data.联系电话+"<td><td><strong>联系地址：</strong>"+d.data.联系地址+'<td></tr><tr style="height:20px;"><td><strong>所属工业园：</strong>'+d.data.所属工业园+"<td><td><strong>房产类型：</strong>"+d.data.房产类型+"<td><td><strong>所属房产：</strong>"+d.data.所属房产+"<td><td><strong>合同开始时间：</strong>"+e("合同开始时间")+"<td><td><strong>合同结束时间：</strong>"+e("合同结束时间")+"<td></tr></table>";var a=new Ext.Panel({title:b.jfgl?"缴费总表":"录入总表",layout:"border",items:[{xtype:"panel",region:"north",cls:"side_col",html:c},new Ext.Hudongsoft.lrzbGrid({region:"center",jfgl:b.jfgl,zbdata:d.data})]});main_tab.add(a).show()}},listeners:{celldblclick:function(a,f,b,d){var c=a.store.getAt(f);a.dispalyDetails()}},initComponent:function(){var b=this;b.title=b.jfgl?"缴费管理":"录入管理";b.store=new Ext.data.JsonStore({storeId:b.jfgl?"jiaofei":"luru",url:"ajax/sfgl/sjlr.aspx?action=list",root:"data",totalProperty:"totalProperty",fields:["id","编码","客户名称","客户编码","联系电话","联系地址","所属工业园","所属房产","房产类型","合同开始时间_年","合同开始时间_月","合同开始时间_日","合同结束时间_年","合同结束时间_月","合同结束时间_日","合同开始时间","合同结束时间","录入状态","缴费状态","录入月份"]});var f=new Ext.data.JsonStore({autoLoad:true,url:"ajax/zlgl/zphtgl.aspx?action=find_gyy_fclx",fields:["lx"]});b.columns=[{header:"序号",sortable:true,resizable:true,dataIndex:"id",width:60},{header:"编码",sortable:true,resizable:true,dataIndex:"编码",width:150},{header:"客户名称",sortable:true,resizable:true,dataIndex:"客户名称",width:70},{header:"所属工业园",sortable:true,resizable:true,dataIndex:"所属工业园",width:80},{header:"所属房产",sortable:true,resizable:true,dataIndex:"所属房产",width:80},{header:"合同开始时间",sortable:true,resizable:true,dataIndex:"合同开始时间",renderer:Ext.Hudongsoft.util.Format.yearMonthDayRenderer_1,width:100},{header:"合同结束时间",sortable:true,resizable:true,dataIndex:"合同结束时间",renderer:Ext.Hudongsoft.util.Format.yearMonthDayRenderer_2,width:100},{header:b.jfgl?"缴费状态":"录入状态",sortable:true,resizable:true,dataIndex:b.jfgl?"缴费状态":"录入状态",renderer:b.jfgl?Ext.Hudongsoft.util.Format.jfztRenderer():Ext.Hudongsoft.util.Format.lrztRenderer(),width:100},{header:"录入月份",sortable:true,resizable:true,dataIndex:"录入月份",width:70}];this.bbar=new Ext.PagingToolbar({pageSize:20,store:b.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});var e=new Ext.form.TextField({width:80});var h=new Ext.GyyLxCombox();var d=new Ext.GyyCombox({nextCombox:h});var g=new Ext.form.TextField({width:80});var c=new Ext.YearCombox();var a=new Ext.MonthCombox();this.tbar=new Ext.Toolbar({enableOverflow:true,items:["名称：",e,"  ","工业园：",d,"  ","类型：",h,"  ","号码：",g,"  ","年：",c,"  ","月：",a,"  ",{text:"搜索",iconCls:"icon-query",handler:function(){b.store.baseParams={mc:e.getValue(),gyy:d.getValue(),gyy_lx:h.getValue(),hm:g.getValue(),nian:c.getValue(),yue:a.getValue()};b.store.load({params:{start:0,limit:20}})}},"->",{text:"查看详情",iconCls:"icon-list",handler:function(){b.dispalyDetails()}}]});b.store.baseParams={nian:now_year,yue:now_month};b.store.load({params:{start:0,limit:20}});Ext.Hudongsoft.sjlrGrid.superclass.initComponent.call(this)}});Ext.Hudongsoft.lrzbGrid=Ext.extend(Ext.grid.GridPanel,{zbdata:null,jfgl:false,store:new Ext.data.JsonStore({url:"ajax/sfgl/sjlr.aspx?action=list_zb",fields:["id","序号","年份月份","单据编号","客户编号","客户名称","日期年","日期月","总费用","缴费金额","余额","录入状态","缴费状态"]}),width:700,height:500,columns:[{header:"序号",dataIndex:"序号",width:60},{header:"年份月份",dataIndex:"年份月份",width:100},{header:"总费用",dataIndex:"总费用",width:80},{header:"缴费金额",dataIndex:"缴费金额",width:80},{header:"余额",dataIndex:"余额",width:80},{header:"录入状态",dataIndex:"录入状态",renderer:Ext.Hudongsoft.util.Format.lrztRenderer(),width:100},{header:"缴费状态",dataIndex:"缴费状态",renderer:Ext.Hudongsoft.util.Format.jfztRenderer(),width:100}],initComponent:function(){var b=this;var c=new Ext.Button({text:"查看详情",iconCls:"icon-list",disabled:true,handler:function(){var f=b.getSelectionModel().getSelected();if(f){var e="";var d=new Ext.Window({title:"收款详细列表",width:815,autoScroll:true,items:[{xtype:"panel",html:'<iframe src="Print.aspx?djbh='+f.data.单据编号+"&ny="+f.data.年份月份+'" width=800 height=500 frameborder="0" scrolling="auto"></iframe>'}]});d.show()}}});var a=new Ext.Button({text:b.jfgl?"缴费":"录入",iconCls:"icon-jiSuan",width:90,disabled:true,handler:function(){function d(){if(a.text=="修改录入"){if(permission_xglr==false){Ext.Msg.alert("提示","没有权限修改已录入的数据");return}}var f=b.getSelectionModel().getSelected();if(!f){return}var i=["编号","消费项目","消费类型","值","倍率","损耗","滞纳金","上月读数","读数","说明","读数输入"];var k=new Ext.data.JsonStore({url:"ajax/sfgl/sjlr.aspx?action=list_lr&id="+b.zbdata.id+"&xh="+f.data.序号,autoLoad:true,fields:i});var h=new Ext.form.NumberField();var n=new Ext.BLCombox();var m=new Ext.SHCombox();var l=new Ext.grid.ColumnModel({columns:[{header:"编号",dataIndex:"编号",width:40},{header:"消费项目",dataIndex:"消费项目",width:110,css:read_only_css},{header:"消费类型",dataIndex:"消费类型",width:70,css:read_only_css},{header:"值",dataIndex:"值",width:70,css:read_only_css},{header:"倍率",dataIndex:"倍率",width:70,css:read_only_css},{header:"损耗",dataIndex:"损耗",width:70,css:read_only_css},{header:"滞纳金",dataIndex:"滞纳金",width:60,css:read_only_css},{header:"上月读数",dataIndex:"上月读数",width:80,css:read_only_css},{header:"读数",dataIndex:"读数",editor:h,width:80},{header:"说明",dataIndex:"说明",width:110,css:read_only_css},{header:"读数输入",dataIndex:"读数输入",width:60,css:read_only_css}],isCellEditable:function(p,q){var o=k.getAt(q);if(o.get(i[p])=="-"){return false}return Ext.grid.ColumnModel.prototype.isCellEditable.call(this,p,q)}});var g=new Ext.grid.EditorGridPanel({store:k,colModel:l,tbar:["注意:灰色项为不可编辑项。","->",{text:"提交",width:80,iconCls:"icon-wanChen",handler:function(){var p=[];var o=true;k.each(function(q){var r=q.data.读数;if(r===""){o=false;return false}p.push(q.data)});if(!o){Ext.Msg.alert("录入","请输入读数");return}Ext.Ajax.request({url:"ajax/sfgl/sjlr.aspx?action=lr_tj",params:{htid:b.zbdata.id,xh:f.data.序号,year:f.data.年份月份.split("/")[0],month:f.data.年份月份.split("/")[1],data:Ext.encode(p)},success:function(){Ext.Msg.alert("提交","数据提交成功！");b.store.reload();j.close();Ext.StoreMgr.get("luru").reload()}})}}]});var j=new Ext.Window({layout:"fit",height:500,width:850,title:"录入",items:g});if(a.text=="修改录入"&&f.data.缴费状态=="已缴费"){Ext.MessageBox.confirm("提示","该条录入已缴费，更改数据会清除缴费信息，需要重新缴费",function(o){if(o=="yes"){j.show()}})}else{j.show()}}function e(){var f=b.getSelectionModel().getSelected();if(!f){return}Ext.Ajax.request({url:"ajax/sfgl/sjlr.aspx?action=list_jf&id="+b.zbdata.id+"&xh="+f.data.序号,success:function(h,k){var n=Ext.decode(h.responseText);var m=new Ext.data.JsonStore({url:"ajax/sfgl/sjlr.aspx?action=list_jf&id="+b.zbdata.id+"&xh="+f.data.序号,data:n.data,fields:["编号","收费项目","收费类型","值","倍率","损耗","滞纳金","上月读数","读数","费用","说明"]});m.on("load",function(p,o){});var g=n.总金额;var j=new Ext.form.NumberField({});var i=new Ext.grid.GridPanel({store:m,columns:[{header:"编号",dataIndex:"编号",width:40},{header:"消费项目",dataIndex:"收费项目",width:110},{header:"消费类型",dataIndex:"收费类型",width:70},{header:"值",dataIndex:"值",width:70},{header:"倍率",dataIndex:"倍率",width:70},{header:"损耗",dataIndex:"损耗",width:70},{header:"滞纳金",dataIndex:"滞纳金",width:70},{header:"上月读数",dataIndex:"上月读数",width:70},{header:"读数",dataIndex:"读数",width:80},{header:"费用",dataIndex:"费用",width:60},{header:"说明",dataIndex:"说明",width:110}],tbar:{items:[""]},bbar:{items:["总金额：￥&nbsp;",""+n.总金额,"上次结余：￥",""+n.上次结余,"&nbsp;&nbsp;&nbsp;需要交费金额：￥",""+n.需要交费金额,"实收金额：&nbsp",j]},buttons:[{text:"提交",iconCls:"icon-wanChen",handler:function(){Ext.Ajax.request({url:"ajax/sfgl/sjlr.aspx?action=jf_tj",params:{zbid:f.data.id,缴费金额:j.getValue(),总费用:n.总金额,上次余额:n.上次结余},success:function(o,p){var q=Ext.decode(o.responseText);if(q.success){Ext.Msg.alert("提交","缴费成功！");b.store.reload();l.close();Ext.StoreMgr.get("jiaofei").reload()}else{Ext.Msg.alert("提交失败",q.errorMessage)}}})}}]});var l=new Ext.Window({layout:"fit",height:500,width:850,title:"缴费",items:i});l.show()}})}if(b.jfgl){e()}else{d()}}});b.getSelectionModel().on("rowselect",function(f,e,d){a.setDisabled(true);c.setDisabled(true);if(b.jfgl){if(d.data.缴费状态=="已缴费"){c.setDisabled(false)}if(d.data.缴费状态=="未缴费"&&d.data.录入状态=="已录入"){a.setDisabled(false)}}else{a.setText("录入");if((d.data.录入状态=="已录入")&&(d.data.缴费状态!="不要交费")){c.setDisabled(false);a.setDisabled(false);a.setText("修改录入")}if(d.data.录入状态=="未录入"){a.setDisabled(false)}}});this.tbar=["->",c,a];b.store.load({params:{htbh:b.zbdata.编码}});Ext.Hudongsoft.lrzbGrid.superclass.initComponent.call(this)}});Ext.Hudongsoft.sksjGrid=Ext.extend(Ext.grid.GridPanel,{djbh:null,store:new Ext.data.JsonStore({url:"ajax/sfgl/sjlr.aspx?action=list_lb",fields:["id","序号","收费项目","收费类型","上月读数","本月读数","值","倍率","损耗","总量","滞纳金","费用","录入状态"]}),width:700,height:400,columns:[{header:"序号",dataIndex:"序号",width:40},{header:"收费项目",dataIndex:"收费项目",width:100},{header:"上月读数",dataIndex:"上月读数",width:60},{header:"本月读数",dataIndex:"本月读数",width:60},{header:"倍率",dataIndex:"倍率",width:60},{header:"损耗",dataIndex:"损耗",width:60},{header:"总量",dataIndex:"总量",width:60},{header:"值",dataIndex:"值",width:60},{header:"滞纳金",dataIndex:"滞纳金",width:60},{header:"费用",dataIndex:"费用",width:60},{header:"说明",dataIndex:"说明",width:80}],initComponent:function(){var a=this;this.tbar=["->",{text:"打印",handler:function(){}}];a.store.load({params:{djbh:a.djbh}});Ext.Hudongsoft.sksjGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.glylbGrid=Ext.extend(Ext.grid.GridPanel,{title:"管理员列表",store:new Ext.data.JsonStore({url:"ajax/xtgl/glylb.aspx?action=list",fields:["id","admin_id","admin_pwd","admin_name","admin_limit","tel","qq","email"]}),width:814,height:450,columns:[{header:"编号",dataIndex:"id",width:100},{header:"管理员帐号",dataIndex:"admin_id",width:100},{header:"名称",dataIndex:"admin_name",width:100},{header:"角色",dataIndex:"admin_limit",width:100}],listeners:{celldblclick:function(a,f,b,d){var c=a.store.getAt(f);a.showDetailWindow(false,c.data)}},showDetailWindow:function(g,d){var b=this;var h=new Ext.form.TextField({fieldLabel:"密码",name:"admin_pwd",width:226,inputType:"password",allowBlank:false});var f=new Ext.form.TextField({fieldLabel:"确认密码",name:"admin_pwd2",width:226,allowBlank:false,inputType:"password"});var e=new Ext.form.ComboBox({fieldLabel:"角色",width:226,name:"admin_limit",triggerAction:"all",editable:false,store:new Ext.data.JsonStore({autoLoad:true,url:"ajax/xtgl/glylb.aspx?action=glygl_js",fields:["js"]}),valueField:"js",displayField:"js"});var c=new Ext.FormPanel({padding:10,items:[{xtype:"textfield",name:"id",hidden:true,hideLabel:true},{fieldLabel:"帐号",name:"admin_id",width:226,xtype:"textfield"},{fieldLabel:"名称",name:"admin_name",width:226,xtype:"textfield"},h,f,e,{fieldLabel:"电话",name:"tel",width:226,xtype:"textfield"},{fieldLabel:"qq",name:"qq",width:226,xtype:"textfield"},{fieldLabel:"邮箱",name:"email",width:226,vtype:"email",xtype:"textfield"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(i){if(h.getValue()!=f.getValue()){Ext.Msg.alert("提示","两次密码输入不一致,请重新输入！");return}c.getForm().submit({url:"ajax/xtgl/glylb.aspx",params:{action:g?"add":"update"},success:function(j,k){a.close();b.store.load();Ext.Msg.alert("管理员管理","数据保存成功!")}})}},{text:"取消",iconCls:"icon-cancel",handler:function(i){a.close()}}]});if(!g&&d){d.admin_pwd2=d.admin_pwd;c.getForm().setValues(d)}var a=new Ext.Window({title:g?"添加管理员":"修改管理员",width:400,items:[c]});a.show()},initComponent:function(){var a=this;this.tbar=[{text:"添加",iconCls:"icon-group-create",handler:function(){a.showDetailWindow(true,null)}},{text:"修改",iconCls:"icon-group-update",handler:function(){var b=a.getSelectionModel().getSelected();if(b){a.showDetailWindow(false,b.data)}}},{text:"删除",iconCls:"icon-group-delete",handler:function(){var b=a.getSelectionModel().getSelected();if(b){Ext.Msg.confirm("删除管理员","确定要删除选中的管理员吗？",function(c){if(c=="yes"){Ext.Ajax.request({url:"ajax/xtgl/glylb.aspx?action=delete",success:function(){Ext.Msg.alert("删除管理员","管理员删除成功！");a.store.reload()},params:{id:b.get("id")}})}})}}}];a.store.load();Ext.Hudongsoft.glylbGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.jsqxGrid=Ext.extend(Ext.grid.GridPanel,{title:"角色权限",store:new Ext.data.JsonStore({url:"ajax/xtgl/jsqx.aspx?action=list",fields:["id","role_id","role_name"]}),width:814,height:450,columns:[{header:"编号",dataIndex:"role_id",width:100},{header:"角色名称",dataIndex:"role_name",width:300}],listeners:{celldblclick:function(a,f,b,d){var c=a.store.getAt(f);a.showDetailWindow(false,c.data)}},showDetailWindow:function(e,d){if(!e&&d.role_name=="总管理员"){Ext.Msg.alert("提示","总管理员不能修改！");return}var b=this;var c=new Ext.FormPanel({id:"form1",padding:10,items:[{xtype:"hidden",name:"id"},{fieldLabel:"角色排列序号",name:"role_id",width:226,xtype:"textfield"},{fieldLabel:"角色名称",name:"role_name",width:226,xtype:"textfield"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(f){if(e&&c.getForm().getValues().role_name=="总管理员"){Ext.Msg.alert("提示","总管理员不能新增！");return}c.getForm().submit({url:"ajax/xtgl/jsqx.aspx",params:{action:e?"add":"update"},success:function(g,h){a.close();b.store.reload()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(f){a.close()}}]});if(!e&&d){c.getForm().setValues(d)}var a=new Ext.Window({title:e?"添加角色":"修改角色",width:400,items:[c]});a.show()},setPermissions:function(b){var a=new Ext.form.FormPanel({width:400,height:300,items:[{xtype:"hidden",name:"id"},{xtype:"hidden",name:"role_name"},{xtype:"checkbox",boxLabel:"数据录入",name:"数据录入"},{xtype:"checkbox",boxLabel:"缴费管理",name:"缴费管理"},{xtype:"checkbox",boxLabel:"工业园管理",name:"工业园管理"},{xtype:"checkbox",boxLabel:"房产管理",name:"房产管理"},{xtype:"checkbox",boxLabel:"客户管理",name:"客户管理"},{xtype:"checkbox",boxLabel:"预定管理",name:"预定管理"},{xtype:"checkbox",boxLabel:"租赁合同管理",name:"租凭合同管理"},{xtype:"checkbox",boxLabel:"合同到期提示",name:"合同到期提示"},{xtype:"checkbox",boxLabel:"收款分类统计",name:"收款分类统计"},{xtype:"checkbox",boxLabel:"收款详细统计",name:"收款详细统计"},{xtype:"checkbox",boxLabel:"角色权限",name:"角色权限"},{xtype:"checkbox",boxLabel:"管理员管理",name:"管理员管理"},{xtype:"checkbox",boxLabel:"修改本身密码",name:"修改本身密码"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(){a.getForm().submit({url:"ajax/xtgl/jsqx.aspx",params:{action:"updatePermissions"},success:function(d,e){c.close()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(){c.close()}}]});var c=new Ext.Window({title:"修改权限",layout:"fit",width:500,height:400,store:self.PermissionsStore,items:a});a.getForm().load({url:"ajax/xtgl/jsqx.aspx?action=set&role_name="+b.role_name,failure:function(d,e){Ext.Msg.alert("Load failed",e.result.errorMessage)}});c.show()},initComponent:function(){var a=this;this.tbar=[{text:"添加",iconCls:"icon-group-create",handler:function(){a.showDetailWindow(true,null)}},{text:"修改",iconCls:"icon-group-update",handler:function(){var b=a.getSelectionModel().getSelected();if(b){a.showDetailWindow(false,b.data)}}},{text:"删除",iconCls:"icon-group-delete",handler:function(){var b=a.getSelectionModel().getSelected();if(b){if(b.data.role_name=="总管理员"){Ext.Msg.alert("提示","总管理员不能删除！");return}Ext.Msg.confirm("删除角色","确定要删除选中的角色吗？",function(c){if(c=="yes"){Ext.Ajax.request({url:"ajax/xtgl/jsqx.aspx?action=delete",success:function(){Ext.Msg.alert("删除角色","角色删除成功！");a.store.reload()},params:{id:b.get("id")}})}})}}},{text:"设置权限",iconCls:"icon-sheZhi",handler:function(){var b=a.getSelectionModel().getSelected();if(b){if(b.json.role_name=="总管理员"){Ext.Msg.alert("提示","总管理员拥有最高权限，不能修改！");return}a.setPermissions(b.data)}}}];a.store.load();Ext.Hudongsoft.jsqxGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.xgmmWin=Ext.extend(Ext.Window,{xtype:"window",title:"修改密码",layout:"fit",width:320,height:150,initComponent:function(){var a=this;var d=new Ext.form.TextField({fieldLabel:"密码",name:"admin_pwd",inputType:"password",allowBlank:false});var c=new Ext.form.TextField({fieldLabel:"确认密码",name:"admin_pwd2",allowBlank:false,inputType:"password"});var b=new Ext.FormPanel({padding:10,items:[d,c],buttons:[{text:"保存",iconCls:"icon-save",handler:function(){if(d.getValue()!=c.getValue()){Ext.Msg.alert("提示","两次密码输入不一致,请重新输入！");return}b.getForm().submit({url:"ajax/xtgl/glylb.aspx",params:{action:"updata_self"},success:function(){a.close();Ext.Msg.alert("修改密码","密码修改成功")}})}},{text:"取消",iconCls:"icon-cancel",handler:function(){a.close()}}]});this.items=[b];Ext.Hudongsoft.xgmmWin.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.htdqtsGrid=Ext.extend(Ext.grid.GridPanel,{xtype:"grid",title:"合同到期列表",store:new Ext.data.JsonStore({root:"data",totalProperty:"totalProperty",url:"ajax/zlgl/htdqts.aspx?action=list",fields:["id","编码","客户名称","所属工业园","所属房产","合同开始时间","合同结束时间","增浮期"]}),width:792,height:560,viewConfig:{getRowClass:function(a,f,d,b){var e=a.data.增浮期;if(!e){return}var c=new Date(e).dateDiff("d",new Date());if(c>=0){return"x-grid-record-red"}}},columns:[{header:"序号",sortable:true,resizable:true,dataIndex:"id",width:50},{header:"编码",sortable:true,resizable:true,dataIndex:"编码",width:160},{header:"客户名称",sortable:true,resizable:true,dataIndex:"客户名称",width:100},{header:"所属工业园",sortable:true,resizable:true,dataIndex:"所属工业园",width:100},{header:"所属房产",sortable:true,resizable:true,dataIndex:"所属房产",width:100},{header:"合同开始时间",sortable:true,resizable:true,renderer:Ext.Hudongsoft.util.Format.dateRenderer(),dataIndex:"合同开始时间",width:100},{header:"合同结束时间",sortable:true,resizable:true,dataIndex:"合同结束时间",renderer:Ext.Hudongsoft.util.Format.dateRenderer(),width:100},{header:"合同状态",sortable:true,resizable:true,dataIndex:"",width:100,renderer:Ext.Hudongsoft.util.Format.htztRenderer()},{header:"增浮期提示",sortable:true,resizable:true,dataIndex:"增浮期",renderer:Ext.Hudongsoft.util.Format.dateRenderer()}],initComponent:function(){var a=this;this.bbar=new Ext.PagingToolbar({pageSize:20,store:a.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});var e=new Ext.data.JsonStore({autoLoad:true,url:"ajax/zlgl/zphtgl.aspx?action=find_gyy_fclx",fields:["lx"]});var d=new Ext.form.TextField({emptyText:"请输入客户姓名",width:100});var b=new Ext.form.TextField({emptyText:"请输入编号",width:150});var f=new Ext.GyyLxCombox();var c=new Ext.GyyCombox({nextCombox:f});this.tbar=["->",{xtype:"label",text:"客户名称："},d,{xtype:"label",text:"工业园："},c,{xtype:"label",text:"类型："},f,{xtype:"label",text:"号码："},b,{text:"搜索",iconCls:"icon-query",handler:function(){a.store.baseParams={iFieldName:d.getValue(),iFieldNo:b.getValue(),gyy:c.getValue(),leix:f.getValue()};a.store.load({params:{start:0,limit:20}})}}];a.store.load({params:{start:0,limit:20}});Ext.Hudongsoft.htdqtsGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.zphtglWin=Ext.extend(Ext.Window,{title:"临时开票",width:520,height:330,initComponent:function(){var a=new Ext.FormPanel({padding:10,items:[{xtype:"textfield",fieldLabel:"工业园名称",name:"role_id",width:226},{xtype:"textfield",fieldLabel:"用户姓名",name:"role_id",width:226},{xtype:"textfield",fieldLabel:"月份",name:"role_id",width:226},{xtype:"textfield",fieldLabel:"客户类型",name:"role_id",width:226},{xtype:"textfield",fieldLabel:"房产",name:"role_id",width:226}]});this.items=[a];Ext.Hudongsoft.zphtglWin.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.skfltsGrid=Ext.extend(Ext.grid.GridPanel,{xfxtj:false,width:792,height:560,columns:[{header:"序号",dataIndex:"序号",width:50},{header:"工业园名称",dataIndex:"工业园名称",width:100},{header:"房产类型",dataIndex:"房产类型",width:100},{header:"消费项目",dataIndex:"消费项目",width:100},{header:"月份",dataIndex:"月份",width:100},{header:"费用",dataIndex:"费用",width:100}],initComponent:function(){var c=this;c.title=c.xfxtj?"收款详细统计":"收款分类统计";var b=new Ext.sfxmCombox({hidden:!c.xfxtj});var f=new Ext.GyyLxCombox({value:"厂房"});var e=new Ext.GyyCombox({nextCombox:f});var d=new Ext.YearCombox();var a=new Ext.MonthCombox();this.tbar=[{xtype:"label",text:"工业园名称："},e,{xtype:"label",text:"房产类型："},f,{xtype:"label",text:"消费项目",hidden:!c.xfxtj},b,{xtype:"label",text:"年："},d,{xtype:"label",text:"月："},a,{text:"搜索",iconCls:"icon-query",handler:function(){c.store.load({params:{xfxtj:c.xfxtj,gyy:e.getValue(),gyy_lx:f.getValue(),xfxm:b.getValue(),nian:d.getValue(),yue:a.getValue()}})}},"->",{text:"打印",iconCls:"icon-batch_print",handler:function(){window.open("Print2.aspx?gyy="+escape(e.getValue())+"&gyy_lx="+escape(f.getValue())+"&xfxm="+escape(b.getValue())+"&nian="+d.getValue()+"&yue="+a.getValue()+"&xfxtj="+c.xfxtj)}}];c.store=new Ext.data.JsonStore({totalProperty:"totalProperty",url:"ajax/zlgl/tj.aspx?action=fltj",fields:["序号","工业园名称","房产类型","消费项目","月份","费用"]});c.store.load({params:{xfxtj:c.xfxtj,gyy_lx:"厂房",nian:d.getValue(),yue:a.getValue()}});Ext.Hudongsoft.skfltsGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.fltjGrid=Ext.extend(Ext.grid.GridPanel,{title:"分类统计",store:new Ext.data.JsonStore({totalProperty:"totalProperty",url:"ajax/zlgl/tj.aspx?action=fltj",fields:["序号","工业园名称","房产类型","消费项目","月份","费用"]}),width:792,height:560,columns:[{header:"序号",dataIndex:"序号",width:100},{header:"工业园名称",dataIndex:"工业园名称",width:100},{header:"房产类型",dataIndex:"房产类型",width:100},{header:"消费项目",dataIndex:"消费项目",width:100},{header:"月份",dataIndex:"月份",width:100},{header:"费用",dataIndex:"费用",width:100}],initComponent:function(){var a=this;this.bbar=new Ext.PagingToolbar({pageSize:20,store:a.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});this.tbar=["->",{xtype:"label",text:"名称："},{xtype:"textfield",fieldLabel:"标签",width:70},{xtype:"label",text:"工业园："},{xtype:"combo",triggerAction:"all",fieldLabel:"标签",width:70},{xtype:"label",text:"类型："},{xtype:"combo",triggerAction:"all",fieldLabel:"标签",width:70},{xtype:"label",text:"号码："},{xtype:"textfield",fieldLabel:"标签",width:70},{text:"搜索",iconCls:"icon-query"}];a.store.load({params:{start:0,limit:20}});Ext.Hudongsoft.fltjGrid.superclass.initComponent.call(this)}});Ext.Hudongsoft.xxtjGrid=Ext.extend(Ext.grid.GridPanel,{title:"分类统计",store:new Ext.data.JsonStore({root:"data",totalProperty:"totalProperty",url:"ajax/zlgl/tj.aspx?action=xxtj",fields:["id","编码","客户名称","所属工业园","所属房产","合同开始时间","合同结束时间"]}),width:792,height:560,columns:[{header:"序号",sortable:true,resizable:true,dataIndex:"id",width:100},{header:"编码",sortable:true,resizable:true,dataIndex:"编码",width:100},{header:"客户名称",sortable:true,resizable:true,dataIndex:"客户名称",width:100},{header:"所属工业园",sortable:true,resizable:true,dataIndex:"所属工业园",width:100},{header:"所属房产",sortable:true,resizable:true,dataIndex:"所属房产",width:100},{header:"合同开始时间",sortable:true,resizable:true,dataIndex:"合同开始时间",width:100},{header:"合同结束时间",sortable:true,resizable:true,dataIndex:"合同结束时间",width:100,format:"m/d/Y"},{header:"合同状态",sortable:true,resizable:true,dataIndex:"",width:100}],initComponent:function(){var a=this;this.bbar=new Ext.PagingToolbar({pageSize:20,store:a.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});this.tbar=["->",{xtype:"label",text:"名称："},{xtype:"textfield",fieldLabel:"标签",width:70},{xtype:"label",text:"工业园："},{xtype:"combo",triggerAction:"all",fieldLabel:"标签",width:70},{xtype:"label",text:"类型："},{xtype:"combo",triggerAction:"all",fieldLabel:"标签",width:70},{xtype:"label",text:"号码："},{xtype:"textfield",fieldLabel:"标签",width:70},{text:"搜索",iconCls:"icon-query"}];a.store.load({params:{start:0,limit:20}});Ext.Hudongsoft.xxtjGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.xxfytjlbGrid=Ext.extend(Ext.grid.GridPanel,{title:"详细费用统计列表",store:new Ext.data.JsonStore({totalProperty:"totalProperty",url:"ajax/zlgl/tj.aspx?action=xxtj",fields:["序号","编码","客户名称","所属工业园","所属房产","合同开始时间","合同结束时间","月份","费用"]}),width:843,height:560,columns:[{header:"序号",dataIndex:"序号",width:50},{header:"编码",dataIndex:"编码",width:160},{header:"客户名称",dataIndex:"客户名称",width:80},{header:"所属工业园",dataIndex:"所属工业园",width:100},{header:"所属房产",dataIndex:"所属房产",width:100},{header:"合同开始时间",dataIndex:"合同开始时间",renderer:Ext.Hudongsoft.util.Format.dateRenderer(),width:100},{header:"合同结束时间",dataIndex:"合同结束时间",renderer:Ext.Hudongsoft.util.Format.dateRenderer(),width:100},{header:"消费项目",dataIndex:"消费项目",width:100},{header:"月份",dataIndex:"月份",width:50},{header:"费用",dataIndex:"费用",width:100,format:"0,000.00"}],initComponent:function(){var b=this;this.bbar=new Ext.PagingToolbar({pageSize:20,store:b.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});var f=new Ext.form.TextField({emptyText:"请输入姓名",width:80});var e=new Ext.GyyLxCombox();var d=new Ext.GyyCombox({nextCombox:e});var c=new Ext.YearCombox();var a=new Ext.MonthCombox();this.tbar=["名称：",f,{xtype:"label",text:"工业园："},d,{xtype:"label",text:"房产类型："},e,{xtype:"label",text:"日期："},c,a,{text:"搜索",iconCls:"icon-query",handler:function(){b.store.baseParams={gyy:d.getValue(),gyy_lx:e.getValue(),iField:f.getValue(),nian:c.getValue(),yue:a.getValue()};b.store.load({params:{start:0,limit:20}})}}];b.store.load({params:{nian:c.getValue(),yue:a.getValue(),start:0,limit:20}});Ext.Hudongsoft.xxfytjlbGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.ydglGrid=Ext.extend(Ext.grid.GridPanel,{title:"预定管理",store:new Ext.data.JsonStore({root:"data",totalProperty:"totalProperty",url:"ajax/zlgl/ydgl.aspx?action=list",fields:["id","编码","客户名称","所属工业园","所属房产","合同开始时间","操作时间","备注"]}),width:792,height:560,columns:[{header:"编号",sortable:true,resizable:true,dataIndex:"id",width:50},{header:"编码",sortable:true,resizable:true,dataIndex:"编码",width:160},{header:"预定客户名称",sortable:true,resizable:true,dataIndex:"客户名称",width:100},{header:"所属工业园",sortable:true,resizable:true,dataIndex:"所属工业园",width:100},{header:"所属房产",sortable:true,resizable:true,dataIndex:"所属房产",width:100},{header:"预定时间",sortable:true,resizable:true,dataIndex:"合同开始时间",renderer:Ext.Hudongsoft.util.Format.dateRenderer(),width:100},{header:"操作时间",sortable:true,resizable:true,dataIndex:"操作时间",width:150,renderer:Ext.Hudongsoft.util.Format.dateTimeRenderer()}],listeners:{celldblclick:function(a,f,b,d){var c=a.store.getAt(f);a.showDetailWindow(false,c.data)}},showDetailWindow:function(g,f){var b=this;var h=new Ext.LinkCombox({width:226,store:new Ext.data.JsonStore({url:"ajax/zlgl/zphtgl.aspx?action=gyy_fc_lb",fields:["fc"]}),displayField:"fc",valueField:"fc",keyField:["gyy"],initComponent:function(){Ext.LinkCombox.superclass.initComponent.call(this)},fieldLabel:"所属房产类型",name:"所属房产"});var d=new Ext.GyyCombox({nextCombox:h,width:226,fieldLabel:"所属工业园",name:"所属工业园"});var c=new Ext.KehuCombox({width:226,name:"客户名称",fieldLabel:"预定客户名称"});var e=new Ext.FormPanel({padding:10,items:[{xtype:"hidden",name:"id"},{fieldLabel:"编码",name:"编码",width:226,readOnly:true,value:"自动产生",xtype:"textfield"},c,d,h,{fieldLabel:"预定时间",name:"合同开始时间",width:226,xtype:"datefield",format:"Y-m-d"},{fieldLabel:"操作时间",name:"操作时间",width:226,readOnly:true,format:"Y-m-d H:i:s",xtype:"datefield",value:new Date()},{fieldLabel:"备注",name:"备注",width:226,height:63,xtype:"textarea"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(i){e.getForm().submit({url:"ajax/zlgl/ydgl.aspx",params:{action:g?"add":"update"},success:function(j,k){a.close();b.store.reload()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(i){a.close()}}]});if(!g&&f){e.getForm().setValues(f)}var a=new Ext.Window({title:g?"新增预定":"修改预定",width:400,items:[e]});a.show()},initComponent:function(){var a=this;this.bbar=new Ext.PagingToolbar({pageSize:20,store:a.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});this.tbar=[{text:"新增",iconCls:"icon-group-create",handler:function(){a.showDetailWindow(true,null)}},{text:"修改",iconCls:"icon-group-update",handler:function(){var b=a.getSelectionModel().getSelected();if(b){a.showDetailWindow(false,b.data)}}},{text:"删除",iconCls:"icon-group-delete",handler:function(){var b=a.getSelectionModel().getSelected();if(b){Ext.Msg.confirm("删除房产","确定要删除选中房产吗？",function(c){if(c=="yes"){Ext.Ajax.request({url:"ajax/zlgl/ydgl.aspx?action=delete",success:function(){Ext.Msg.alert("删除房产","房产删除成功！");a.store.reload()},params:{id:b.get("id")}})}})}}},"->",{text:"转为正式合同",iconCls:"icon-jobSum",handler:function(){var b=a.getSelectionModel().getSelected();if(b){Ext.Msg.confirm("转为正式合同","确定要转为正式合同吗？",function(c){if(c=="yes"){Ext.Ajax.request({url:"ajax/zlgl/ydgl.aspx?action=change",success:function(){Ext.Msg.alert("转为正式合同","转为正式合同成功！");a.store.reload()},params:{id:b.get("id")}})}})}}}];a.store.load({params:{start:0,limit:20}});Ext.Hudongsoft.ydglGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.MyGrid=Ext.extend(Ext.grid.GridPanel,{xtype:"grid",title:"总费用统计列表",store:{xtype:"jsonstore",},width:792,height:560,columns:[{header:"序号",sortable:true,resizable:true,dataIndex:"data1",width:40},{header:"编码",sortable:true,resizable:true,dataIndex:"data2",width:100},{header:"客户名称",sortable:true,resizable:true,dataIndex:"data3",width:100},{header:"所属工业园",sortable:true,resizable:true,dataIndex:"",width:100},{header:"所属房产",sortable:true,resizable:true,dataIndex:"",width:100,format:"m/d/Y"},{header:"合同开始时间",sortable:true,resizable:true,dataIndex:"",width:100},{header:"合同结束时间",sortable:true,resizable:true,dataIndex:"",width:100},{header:"月份",sortable:true,resizable:true,dataIndex:"",width:70,format:"m/d/Y"},{header:"费用",sortable:true,resizable:true,dataIndex:"",width:100,format:"0,000.00"}],initComponent:function(){this.tbar=[{xtype:"label",text:"名称："},{xtype:"textfield",fieldLabel:"标签"},{xtype:"label",text:"工业园："},{xtype:"combo",triggerAction:"all",fieldLabel:"标签",width:70},{xtype:"label",text:"类型："},{xtype:"combo",triggerAction:"all",fieldLabel:"标签",width:70},{xtype:"label",text:"日期："},{xtype:"datefield",fieldLabel:"标签"},{text:"搜索"}];Ext.MyGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.zphtglGrid=Ext.extend(Ext.grid.GridPanel,{title:"合同列表",store:new Ext.data.JsonStore({url:"ajax/zlgl/zphtgl.aspx?action=list",root:"data",totalProperty:"totalProperty",fields:["id","编码","客户名称","所属工业园","房产类型","所属房产","合同开始时间","合同结束时间","增浮期","合同状态","操作时间","备注","客户编码"]}),width:792,height:560,viewConfig:{getRowClass:function(a,f,d,b){var e=a.data.增浮期;if(!e){return}var c=new Date(e).dateDiff("d",new Date());if(c>=0){return"x-grid-record-red"}}},columns:[{header:"序号",sortable:true,resizable:true,dataIndex:"id",width:50},{header:"编码",sortable:true,resizable:true,dataIndex:"编码",width:160},{header:"客户名称",sortable:true,resizable:true,dataIndex:"客户名称",width:100},{header:"所属工业园",sortable:true,resizable:true,dataIndex:"所属工业园",width:100},{header:"所属房产",sortable:true,resizable:true,dataIndex:"所属房产",width:100},{header:"合同开始时间",sortable:true,resizable:true,dataIndex:"合同开始时间",renderer:Ext.Hudongsoft.util.Format.dateRenderer(),width:100},{header:"合同结束时间",dataIndex:"合同结束时间",renderer:Ext.Hudongsoft.util.Format.dateRenderer(),width:100},{header:"增浮期",dataIndex:"增浮期",renderer:Ext.Hudongsoft.util.Format.dateRenderer(),width:100},{header:"合同状态",sortable:true,resizable:true,dataIndex:"合同状态",width:100,renderer:Ext.Hudongsoft.util.Format.htztRenderer()}],listeners:{celldblclick:function(a,f,b,d){var c=a.store.getAt(f);a.showDetailWindow(false,c.data)}},showDetailWindow:function(g,f){var b=this;var h=new Ext.LinkCombox({width:226,append:false,store:new Ext.data.JsonStore({url:"ajax/zlgl/zphtgl.aspx?action=gyy_fc_lb",fields:["fc"]}),displayField:"fc",valueField:"fc",keyField:["gyy"],initComponent:function(){Ext.LinkCombox.superclass.initComponent.call(this)},fieldLabel:"所属房产",name:"所属房产"});var d=new Ext.GyyCombox({append:false,nextCombox:h,width:226,fieldLabel:"所属工业园",name:"所属工业园"});var c=new Ext.KehuCombox({width:226,name:"客户名称",fieldLabel:"客户名称"});var e=new Ext.FormPanel({padding:10,items:[{xtype:"hidden",name:"id"},{fieldLabel:"编码",name:"编码",width:226,readOnly:true,value:"自动产生",xtype:"textfield"},c,d,h,{fieldLabel:"合同开始时间",name:"合同开始时间",width:226,allowBlank:false,format:"Y-m-d",xtype:"datefield",value:new Date()},{fieldLabel:"合同结束时间",name:"合同结束时间",width:226,allowBlank:false,format:"Y-m-d",xtype:"datefield",value:new Date()},{fieldLabel:"增浮期",name:"增浮期",width:226,format:"Y-m-d",xtype:"datefield",value:new Date()},{fieldLabel:"操作时间",name:"操作时间",width:226,readOnly:true,format:"Y-m-d H:i:s",xtype:"datefield",value:new Date()},{fieldLabel:"备注",name:"备注",width:226,height:63,xtype:"textarea"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(i){e.getForm().submit({url:"ajax/zlgl/zphtgl.aspx",params:{action:g?"add":"update"},success:function(j,k){a.close();b.store.reload()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(i){a.close()}}]});if(!g&&f){e.getForm().setValues(f)}var a=new Ext.Window({title:g?"新增合同":"修改合同",width:390,items:[e]});a.show()},initComponent:function(){var a=this;this.bbar=new Ext.PagingToolbar({pageSize:20,store:a.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});var e=new Ext.data.JsonStore({autoLoad:true,url:"ajax/zlgl/zphtgl.aspx?action=find_gyy_fclx",fields:["lx"]});var d=new Ext.form.TextField({emptyText:"请输入客户姓名",width:100});var b=new Ext.form.TextField({emptyText:"请输入编号",width:150});var f=new Ext.GyyLxCombox();var c=new Ext.GyyCombox({nextCombox:f});this.tbar=[{text:"新增合同",iconCls:"icon-group-create",handler:function(){a.showDetailWindow(true,null)}},{text:"修改合同",iconCls:"icon-group-update",handler:function(){var g=a.getSelectionModel().getSelected();if(g){a.showDetailWindow(false,g.data)}}},{text:"删除合同",iconCls:"icon-group-delete",handler:function(){var g=a.getSelectionModel().getSelected();if(g){Ext.Msg.confirm("删除合同","确定要删除选中合同吗？",function(h){if(h=="yes"){Ext.Ajax.request({url:"ajax/zlgl/zphtgl.aspx?action=delete",success:function(){Ext.Msg.alert("删除合同","合同删除成功！");a.store.reload()},params:{id:g.get("id")}})}})}}},{text:"编辑固定消费项目",iconCls:"icon-xieGenJin",handler:function(){var g=a.getSelectionModel().getSelected();if(!g){return}var j=["id","编号","消费项目","消费类型","值","倍率","损耗","滞纳金","前期读数","说明","读数导入","项目导入","合同编号"];var l=new Ext.data.JsonStore({url:"ajax/zlgl/zphtgl.aspx?action=edit_gdxfx&id="+g.data.id,root:"data",autoLoad:true,fields:j});var i=new Ext.form.TextField();var o=new Ext.BLCombox();var n=new Ext.SHCombox();var m=new Ext.grid.ColumnModel({columns:[{header:"编号",dataIndex:"编号",width:40},{header:"消费项目",dataIndex:"消费项目",width:120,css:read_only_css},{header:"消费类型",dataIndex:"消费类型",width:80,css:read_only_css},{header:"值",dataIndex:"值",editor:i,width:70,renderer:valueRenderer},{header:"倍率",dataIndex:"倍率",editor:o,width:70,renderer:valueRenderer},{header:"损耗",dataIndex:"损耗",editor:n,width:70,renderer:percentRenderer},{header:"滞纳金",dataIndex:"滞纳金",editor:n,width:70,renderer:percentRenderer},{header:"前期读数",dataIndex:"前期读数",editor:i,width:80,renderer:valueRenderer},{header:"说明",dataIndex:"说明",editor:i,width:120},{header:"读数导入",dataIndex:"读数导入",width:60,css:read_only_css},{header:"项目导入",dataIndex:"项目导入",width:60,css:read_only_css}],isCellEditable:function(q,r){var p=l.getAt(r);if(p.get(j[q])=="-"){return false}return Ext.grid.ColumnModel.prototype.isCellEditable.call(this,q,r)}});var h=new Ext.grid.EditorGridPanel({store:l,id:"xxxxxxxx",colModel:m,tbar:["注意:灰色项为不可编辑项。",{text:"新增消费项",iconCls:"icon-group-create",handler:function(){var p=a.getSelectionModel().getSelected();addxfx(null,l,p,function(q){q["编号"]=l.getCount()+1;var s=new Ext.data.Record(q);l.add(s)})}},{text:"删除消费项",iconCls:"icon-group-delete",handler:function(){var p=h.getSelectionModel().getSelectedCell();if(p){Ext.Msg.confirm("删除消费项","确定要删除选中的消费项吗？",function(q){if(q=="yes"){h.store.removeAt(p[0])}})}}},"->",{text:"导入到合同",handler:function(){var p=[];l.each(function(q){p.push(q.data)});Ext.Ajax.request({url:"ajax/zlgl/zphtgl.aspx?action=import_gdxfx",params:{id:g.data.id,data:Ext.encode(p)},success:function(){Ext.Msg.alert("固定消费项导入","数据导入成功！");k.close()}})}}]});var k=new Ext.Window({layout:"fit",height:500,width:900,title:"固定消费项目",items:h});k.show()}},"->",d,{xtype:"label",text:"工业园："},c,{xtype:"label",text:"类型："},f,b,{text:"搜索",iconCls:"icon-query",handler:function(){a.store.baseParams={iFieldName:d.getValue(),iFieldNo:b.getValue(),gyy:c.getValue(),leix:f.getValue()};a.store.load({params:{start:0,limit:20}})}}];a.store.load({params:{start:0,limit:20}});Ext.Hudongsoft.zphtglGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.fcglGrid=Ext.extend(Ext.grid.GridPanel,{xtype:"grid",title:"房产管理",store:new Ext.data.JsonStore({root:"data",totalProperty:"totalProperty",url:"ajax/zygl/fcgl.aspx?action=list",fields:["id","工业园名称","房产类型","房号","描述","房型","朝向","房屋结构"]}),width:785,height:576,columns:[{header:"序号",sortable:true,resizable:true,dataIndex:"id",width:100},{header:"工业园名称",sortable:true,resizable:true,dataIndex:"工业园名称",width:100},{header:"房产类型",sortable:true,resizable:true,dataIndex:"房产类型",width:100},{header:"房号",sortable:true,resizable:true,dataIndex:"房号",width:100}],listeners:{celldblclick:function(a,f,b,d){var c=a.store.getAt(f);a.showDetailWindow(false,c.data)}},showDetailWindow:function(f,e){var b=this;var g=new Ext.GyyLxCombox({width:130,emptyText:"请选择",fieldLabel:"类型",name:"房产类型"});var c=new Ext.GyyCombox({nextCombox:g,width:130,emptyText:"请选择",fieldLabel:"工业园",name:"工业园名称"});var d=new Ext.FormPanel({id:"form1",padding:10,items:[{xtype:"hidden",name:"id"},{fieldLabel:"房号",name:"房号",xtype:"textfield"},c,g,{fieldLabel:"描述",name:"描述",xtype:"textfield"},{fieldLabel:"房型",name:"房型",xtype:"textfield"},{fieldLabel:"朝向",name:"朝向",xtype:"textfield"},{fieldLabel:"房屋结构",name:"房屋结构",xtype:"textfield"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(h){d.getForm().submit({url:"ajax/zygl/fcgl.aspx",params:{action:f?"add":"update"},success:function(i,j){a.close();b.store.reload()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(h){a.close()}}]});if(!f&&e){d.getForm().setValues(e)}var a=new Ext.Window({title:f?"新增房产":"修改房产",width:300,items:[d]});a.show()},initComponent:function(){var a=this;this.bbar=new Ext.PagingToolbar({pageSize:20,store:a.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});this.tbar=[{text:"新增房产",iconCls:"icon-group-create",handler:function(){a.showDetailWindow(true,null)}},{text:"修改房产",iconCls:"icon-group-update",handler:function(){var b=a.getSelectionModel().getSelected();if(b){a.showDetailWindow(false,b.data)}}},{text:"删除房产",iconCls:"icon-group-delete",handler:function(){var b=a.getSelectionModel().getSelected();if(b){Ext.Msg.confirm("删除房产","确定要删除选中房产吗？",function(c){if(c=="yes"){Ext.Ajax.request({url:"ajax/zygl/fcgl.aspx?action=delete",success:function(){Ext.Msg.alert("删除房产","房产删除成功！");a.store.reload()},params:{id:b.get("id")}})}})}}}];a.store.load({params:{start:0,limit:20}});Ext.Hudongsoft.fcglGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.gslbGrid=Ext.extend(Ext.grid.GridPanel,{xtype:"grid",title:"公司列表",store:new Ext.data.JsonStore({root:"data",totalProperty:"totalProperty",url:"ajax/zygl/gslb.aspx?action=list",fields:["id","编码","名称","描述","联系人","联系电话","助记码","注册号","法人代表","办公地址","联系方法","备注","成立日期_年","成立日期_月","成立日期_日"]}),width:792,height:560,columns:[{header:"编号",sortable:true,resizable:true,dataIndex:"id",width:100},{header:"编码",sortable:true,resizable:true,dataIndex:"编码",width:100},{header:"名称",sortable:true,resizable:true,dataIndex:"名称",width:100},{header:"描述",sortable:true,resizable:true,dataIndex:"描述",width:100},{header:"联系人",sortable:true,resizable:true,dataIndex:"联系人",width:100},{header:"联系电话",sortable:true,resizable:true,dataIndex:"联系电话",width:100}],listeners:{celldblclick:function(a,f,b,d){var c=a.store.getAt(f);a.showDetailWindow(false,c.data)}},showDetailWindow:function(e,d){var b=this;var c=new Ext.FormPanel({id:"form1",padding:10,items:[{xtype:"hidden",name:"id"},{fieldLabel:"编码",name:"编码",width:226,xtype:"textfield"},{fieldLabel:"名称",name:"名称",width:226,xtype:"textfield"},{fieldLabel:"描述",name:"描述",width:226,xtype:"textfield"},{fieldLabel:"助记码",name:"助记码",width:226,xtype:"textfield"},{fieldLabel:"注册号",name:"注册号",width:226,xtype:"textfield"},{fieldLabel:"成立日期",name:"成立日期",width:226,xtype:"datefield",format:"Y-m-d"},{fieldLabel:"法人代表",name:"法人代表",width:226,xtype:"textfield"},{fieldLabel:"办公地址",name:"办公地址",width:226,xtype:"textfield"},{fieldLabel:"联系电话",name:"联系电话",width:226,xtype:"textfield"},{fieldLabel:"联系方法",name:"联系方法",width:226,xtype:"textfield"},{fieldLabel:"联系人",name:"联系人",width:226,xtype:"textfield"},{fieldLabel:"备注",name:"备注",width:226,height:60,xtype:"textarea"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(f){c.getForm().submit({url:"ajax/zygl/gslb.aspx",params:{action:e?"add":"update"},success:function(g,h){a.close();b.store.reload()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(f){a.close()}}]});if(!e&&d){d.成立日期=new Date(d.成立日期_年,d.成立日期_月-1,d.成立日期_日);c.getForm().setValues(d)}var a=new Ext.Window({title:e?"新增公司":"修改公司",width:400,items:[c]});a.show()},initComponent:function(){var a=this;var b=new Ext.form.TextField({emptyText:"请输入姓名",width:150});this.bbar=new Ext.PagingToolbar({pageSize:20,store:a.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});this.tbar=[{text:"新增",iconCls:"icon-group-create",handler:function(){a.showDetailWindow(true,null)}},{text:"修改",iconCls:"icon-group-update",handler:function(){var c=a.getSelectionModel().getSelected();if(c){a.showDetailWindow(false,c.data)}}},{text:"删除",iconCls:"icon-group-delete",handler:function(){var c=a.getSelectionModel().getSelected();if(c){Ext.Msg.confirm("删除公司","确定要删除选中的公司吗？",function(d){if(d=="yes"){Ext.Ajax.request({url:"ajax/zygl/gslb.aspx?action=delete",success:function(){Ext.Msg.alert("删除公司","公司删除成功！");a.store.reload()},params:{id:c.get("id")}})}})}}},"->",{xtype:"label",text:"姓名："},b,{text:"搜索",iconCls:"icon-query",handler:function(){a.store.load({params:{iField:b.getValue()}})}}];a.store.load();Ext.Hudongsoft.gslbGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.gyyglGrid=Ext.extend(Ext.grid.GridPanel,{xtype:"grid",title:"工业园管理列表",store:new Ext.data.JsonStore({url:"ajax/zygl/gyygl.aspx?action=list",fields:["id","序号","工业园名称","工业园面积"]}),width:778,height:544,columns:[{header:"编号",sortable:true,resizable:true,dataIndex:"序号",width:100},{header:"工业园名称",sortable:true,resizable:true,dataIndex:"工业园名称",width:100},{header:"工业面积（平方米）",sortable:true,resizable:true,dataIndex:"工业园面积",width:120}],listeners:{celldblclick:function(a,f,b,d){var c=a.store.getAt(f);a.showDetailWindow(false,c.data)}},showDetailWindow:function(e,d){var b=this;var c=new Ext.FormPanel({padding:10,items:[{xtype:"hidden",name:"id"},{fieldLabel:"序号",name:"序号",allowBlank:false,xtype:"textfield"},{fieldLabel:"工业园名称",name:"工业园名称",allowBlank:false,xtype:"textfield"},{fieldLabel:"工园业面积",name:"工业园面积",allowBlank:false,xtype:"textfield"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(f){c.getForm().submit({url:"ajax/zygl/gyygl.aspx",params:{action:e?"add":"update"},success:function(g,h){a.close();b.store.reload()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(f){a.close()}}]});if(!e&&d){c.getForm().setValues(d)}var a=new Ext.Window({title:e?"新增工业园":"修改工业园",width:300,items:[c]});a.show()},initComponent:function(){var a=this;this.bbar=new Ext.PagingToolbar({pageSize:20,store:a.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});this.tbar=[{text:"添加工业园",iconCls:"icon-group-create",handler:function(){a.showDetailWindow(true,null)}},{text:"修改工业园",iconCls:"icon-group-update",handler:function(){var b=a.getSelectionModel().getSelected();if(b){a.showDetailWindow(false,b.data)}}},{text:"删除工业园",iconCls:"icon-group-delete",handler:function(){var b=a.getSelectionModel().getSelected();if(b){Ext.Msg.confirm("删除工业园","确定要删除选中工业园吗？",function(c){if(c=="yes"){Ext.Ajax.request({url:"ajax/zygl/gyygl.aspx?action=delete",success:function(){Ext.Msg.alert("删除工业园","工业园删除成功！");a.store.reload()},params:{id:b.get("id")}})}})}}},{text:"编辑房产类型",iconCls:"icon-xieGenJin",handler:function(){var d=a.getSelectionModel().getSelected();if(!d){return}var c=new Ext.data.JsonStore({url:"ajax/zygl/gyygl.aspx?action=lx_list&find_id="+escape(d.data.工业园名称),fields:["id","序号","工业园名称","房产类型"]});var b=new Ext.grid.GridPanel({store:c,layout:"fit",columns:[{header:"编号",sortable:true,resizable:true,dataIndex:"序号",width:200},{header:"房产类型",sortable:true,resizable:true,dataIndex:"房产类型",width:300}],listeners:{celldblclick:function(g,k,h,i){var j=g.store.getAt(k);f(false,j.data)}}});function f(j,i){var g=new Ext.FormPanel({padding:10,items:[{xtype:"hidden",name:"id",value:d.json.id},{xtype:"hidden",name:"工业园名称",value:d.json.工业园名称},{fieldLabel:"编号",name:"序号",allowBlank:false,xtype:"textfield"},{fieldLabel:"房产类型",name:"房产类型",allowBlank:false,xtype:"textfield"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(){g.getForm().submit({url:"ajax/zygl/gyygl.aspx",params:{action:j?"addlx":"updatelx"},success:function(k,l){h.close();c.reload()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(){h.close()}}]});var h=new Ext.Window({title:j?"新增类型":"修改类型",width:300,height:150,layout:"fit",items:[g]});if(!j&&i){g.getForm().setValues(i)}h.show()}var e=new Ext.Window({title:"房产类型列表",width:600,height:400,layout:"fit",tbar:[{text:"新增类型",iconCls:"icon-group-create",handler:function(){f(true,null)}},{text:"修改类型",iconCls:"icon-group-update",handler:function(){var g=b.getSelectionModel().getSelected();f(false,g.data)}},{text:"删除类型",iconCls:"icon-group-delete",handler:function(){var g=b.getSelectionModel().getSelected();if(g){Ext.Msg.confirm("删除房产类型","确定要删除选中的房产类型吗？",function(h){if(h=="yes"){Ext.Ajax.request({url:"ajax/zygl/gyygl.aspx?action=deletelx",success:function(){Ext.Msg.alert("删除房产类型","房产类型删除成功！");c.reload()},params:{id:g.get("id")}})}})}}},{text:"编辑房产消费列表",iconCls:"icon-xieGenJin",handler:function(){var i=b.getSelectionModel().getSelected();var h=new Ext.data.JsonStore({url:"ajax/zygl/gyygl.aspx?action=fcxf_list",fields:["id","序号","工业园名称","房产类型","消费项目","消费类型","值","倍率","损耗","滞纳金","说明"],baseParams:{gyyName:i.data.工业园名称,fclx:i.data.房产类型}});var j=new Ext.grid.GridPanel({store:h,columns:[{header:"编号",sortable:true,resizable:true,dataIndex:"序号",width:50},{header:"消费项目",sortable:true,resizable:true,dataIndex:"消费项目",width:100},{header:"消费类型",sortable:true,resizable:true,dataIndex:"消费类型",width:100},{header:"值",sortable:true,resizable:true,dataIndex:"值",width:100},{header:"倍率",sortable:true,resizable:true,dataIndex:"倍率",width:100},{header:"损耗",sortable:true,resizable:true,dataIndex:"损耗",width:100},{header:"滞纳金",sortable:true,resizable:true,dataIndex:"滞纳金",width:100},{header:"说明",dataIndex:"说明",width:100}]});var g=new Ext.Window({layout:"fit",width:800,height:400,tbar:[{text:"新增房产消费",iconCls:"icon-group-create",handler:function(){addxfx(i,h,null)}},{text:"删除房产消费",iconCls:"icon-group-update",handler:function(){var k=j.getSelectionModel().getSelected();if(k){Ext.Msg.confirm("删除房产消费","确定要删除选中的房产消费吗？",function(l){if(l=="yes"){Ext.Ajax.request({url:"ajax/zygl/gyygl.aspx?action=delete_fcxf",success:function(){Ext.Msg.alert("删除房产消费","房产消费删除成功！");h.reload()},params:{id:k.get("id")}})}})}}}],items:[j]});g.show();h.load()}}],items:[b]});e.show();c.load()}}];a.store.load();Ext.Hudongsoft.gyyglGrid.superclass.initComponent.call(this)}});Ext.namespace("Ext.Hudongsoft");Ext.Hudongsoft.zrrlbGrid=Ext.extend(Ext.grid.GridPanel,{title:"自然人列表",store:new Ext.data.JsonStore({root:"data",totalProperty:"totalProperty",url:"ajax/zygl/zrrlb.aspx?action=list",fields:["id","编码","名称","描述","联系人","联系电话","助记码","性别","证件名称","证件号码","籍贯","联系地址","备注","出生日期_年","出生日期_月","出生日期_日","canDelete"]}),width:792,height:560,columns:[{header:"序号",sortable:true,resizable:true,dataIndex:"id",width:50},{header:"编码",dataIndex:"编码",width:160},{header:"名称",sortable:true,resizable:true,dataIndex:"名称",width:100},{header:"描述",sortable:true,resizable:true,dataIndex:"描述",width:100},{header:"联系人",sortable:true,resizable:true,dataIndex:"联系人",width:100},{header:"联系电话",sortable:true,resizable:true,dataIndex:"联系电话",width:100}],listeners:{celldblclick:function(a,f,b,d){var c=a.store.getAt(f);a.showDetailWindow(false,c.data)}},showDetailWindow:function(g,f){var b=this;var e=new Ext.form.ComboBox({fieldLabel:"性别",width:226,mode:"local",name:"性别",triggerAction:"all",editable:false,store:new Ext.data.SimpleStore({fields:["myId","displayText"],data:[["男","男"],["女","女"]]}),value:"男",valueField:"myId",displayField:"displayText"});var c=new Ext.form.ComboBox({fieldLabel:"籍贯",name:"籍贯",width:226,mode:"local",name:"籍贯",triggerAction:"all",editable:false,store:new Ext.data.SimpleStore({fields:["id","Text"],data:[["河北省","河北省"],["山西省","山西省"],["辽宁省","辽宁省"],["吉林省","吉林省"],["黑龙江省","黑龙江省"],["江苏省","江苏省"],["浙江省","浙江省"],["安徽省","安徽省"],["福建省","福建省"],["江西省","江西省"],["山东省","山东省"],["河南省","河南省"],["湖北省","湖北省"],["湖南省","湖南省"],["广东省","广东省"],["海南省","海南省"],["四川省","四川省"],["贵州省","贵州省"],["云南省","云南省"],["陕西省","陕西省"],["甘肃省","甘肃省"],["青海省","青海省"],["台湾省","台湾省"],["北京市","北京市"],["天津市","天津市"],["重庆市","重庆市"],["上海市","上海市"],["香港","香港"],["澳门","澳门"],["内蒙古","内蒙古"],["广西","广西"],["宁夏","宁夏"],["新疆","新疆"],["西藏","西藏"]]}),emptyText:"请选择",valueField:"id",displayField:"Text"});var d=new Ext.FormPanel({id:"form1",padding:10,items:[{xtype:"hidden",name:"id"},{fieldLabel:"编码",name:"编码",width:226,readOnly:true,value:"自动产生",xtype:"textfield"},{fieldLabel:"名称",name:"名称",width:226,xtype:"textfield"},{fieldLabel:"描述",name:"描述",width:226,xtype:"textfield"},{fieldLabel:"助记码",name:"助记码",width:226,xtype:"textfield"},e,{fieldLabel:"出生日期",name:"出生日期",width:226,xtype:"datefield",format:"Y-m-d"},{fieldLabel:"证件名称",name:"证件名称",width:226,xtype:"textfield"},{fieldLabel:"证件号码",name:"证件号码",width:226,xtype:"textfield"},c,{fieldLabel:"联系电话",name:"联系电话",width:226,xtype:"textfield"},{fieldLabel:"联系地址",name:"联系地址",width:226,xtype:"textfield"},{fieldLabel:"联系人",name:"联系人",width:226,xtype:"textfield"},{fieldLabel:"备注",name:"备注",width:226,height:63,xtype:"textarea"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(h){d.getForm().submit({url:"ajax/zygl/zrrlb.aspx",params:{action:g?"add":"update"},success:function(i,j){a.close();b.store.reload()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(h){a.close()}}]});if(!g&&f){f.出生日期=new Date(f.出生日期_年,f.出生日期_月-1,f.出生日期_日);d.getForm().setValues(f)}var a=new Ext.Window({title:g?"新增自然人":"修改自然人",width:400,items:[d]});a.show()},addhtWindow:function(e){var a=this;var g=new Ext.LinkCombox({width:226,append:false,store:new Ext.data.JsonStore({url:"ajax/zlgl/zphtgl.aspx?action=gyy_fc_lb",fields:["fc"]}),displayField:"fc",valueField:"fc",keyField:["gyy"],initComponent:function(){Ext.LinkCombox.superclass.initComponent.call(this)},fieldLabel:"所属房产",name:"所属房产"});var c=new Ext.GyyCombox({append:false,nextCombox:g,width:226,fieldLabel:"所属工业园",name:"所属工业园"});var b=new Ext.KehuCombox({width:226,name:"客户名称",fieldLabel:"客户名称"});var d=new Ext.FormPanel({padding:10,items:[{xtype:"hidden",name:"id"},{fieldLabel:"编码",name:"编码",width:226,readOnly:true,value:"自动产生",xtype:"textfield"},b,c,g,{fieldLabel:"合同开始时间",name:"合同开始时间",width:226,allowBlank:false,format:"Y-m-d",xtype:"datefield",value:new Date()},{fieldLabel:"合同结束时间",name:"合同结束时间",width:226,allowBlank:false,format:"Y-m-d",xtype:"datefield",value:new Date()},{fieldLabel:"增浮期",name:"增浮期",width:226,format:"Y-m-d",xtype:"datefield",value:new Date()},{fieldLabel:"操作时间",name:"操作时间",width:226,readOnly:true,format:"Y-m-d H:i:s",xtype:"datefield",value:new Date()},{fieldLabel:"备注",name:"备注",width:226,height:63,xtype:"textarea"}],buttons:[{text:"保存",iconCls:"icon-save",handler:function(h){d.getForm().submit({url:"ajax/zlgl/zphtgl.aspx",params:{action:"add"},success:function(i,j){f.close()}})}},{text:"取消",iconCls:"icon-cancel",handler:function(h){f.close()}}]});var f=new Ext.Window({title:"新增合同",width:390,items:[d]});f.show();b.setValue(e.名称)},initComponent:function(){var a=this;var c=new Ext.form.TextField({emptyText:"请输入姓名",width:150});this.bbar=new Ext.PagingToolbar({pageSize:20,store:a.store,displayInfo:true,plugins:[new Ext.ux.ProgressBarPager()]});var b=new Ext.Button({text:"删除",iconCls:"icon-group-delete",handler:function(){var d=a.getSelectionModel().getSelected();if(d){Ext.Msg.confirm("删除自然人","确定要删除选中的自然人吗？",function(e){if(e=="yes"){Ext.Ajax.request({url:"ajax/zygl/zrrlb.aspx?action=delete",success:function(){Ext.Msg.alert("删除自然人","自然人删除成功！");a.store.reload()},params:{id:d.get("id")}})}})}}});this.tbar=[{text:"新增",iconCls:"icon-group-create",handler:function(){a.showDetailWindow(true,null)}},{text:"修改",iconCls:"icon-group-update",handler:function(){var d=a.getSelectionModel().getSelected();if(d){a.showDetailWindow(false,d.data)}}},b,{text:"添加合同",iconCls:"icon-group-create",handler:function(){var d=a.getSelectionModel().getSelected();if(d){a.addhtWindow(d.data)}}},"->",{xtype:"label",text:"姓名："},c,{text:"搜索",iconCls:"icon-query",handler:function(){a.store.load({params:{iField:c.getValue()}})}}];a.getSelectionModel().on("rowselect",function(f,e,d){b.setDisabled(!d.data.canDelete)});a.store.load({params:{start:0,limit:20}});Ext.Hudongsoft.zrrlbGrid.superclass.initComponent.call(this)}});